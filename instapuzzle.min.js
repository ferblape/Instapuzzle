function setCookie(b,c){var a=new Date;a.setTime(a.getTime()+1296E6);a="; expires="+a.toGMTString();document.cookie=b+"="+c+a+"; path=/"}function getCookie(b){b+="=";for(var c=document.cookie.split(";"),a=0;a<c.length;a++){for(var d=c[a];d.charAt(0)==" ";)d=d.substring(1,d.length);if(d.indexOf(b)===0)return d.substring(b.length,d.length)}return null}
function Timer(b){return{seconds:0,minutes:0,interval:null,printTime:function(){jQuery(b).html((this.minutes<10?"0"+this.minutes:this.minutes)+":"+(this.seconds<10?"0"+this.seconds:this.seconds))},reset:function(){this.minutes=this.seconds=0;this.printTime()},increaseTime:function(){this.seconds<59?this.seconds++:(this.seconds=0,this.minutes++);this.printTime()},start:function(){this.interval=setInterval(function(b){b.increaseTime()},1E3,this)},stop:function(){this.interval=clearInterval(this.interval)}}}
function Puzzle(b,c){for(var a=b*b,d=612/b,e=[],f=[],g=0;g<a;g++)e.push(g),f.push(g);for(var f=f.sort(function(){return 0.5-Math.random()}).sort(function(){return 0.5-Math.random()}),j=f[a-1],i=[],g=0;g<b;g++)for(a=0;a<b;a++){var k=jQuery("<img />").attr("src",c).attr("height",612).attr("width",612).css("position","relative").css("top",-1*g*d).css("left",-1*a*d);i.push(k)}jQuery("#puzzle").html("");g=jQuery("<div>");solution_image=jQuery("<img />").attr("src",c);g.append(solution_image);jQuery("#puzzle").append(g);
jQuery(".play").attr("disabled",!1);return{instagram_image_size:612,solution:e,positions:f,blank_position:j,images:i,solution_image:null,started:!1,disable_movements:!1,n:b,timer:new Timer(".time"),moves:0,pieces:[],start:function(){var a=this;solution_image.fadeOut(400,function(){jQuery("#puzzle").html("");for(var h=0;h<b;h++)for(var c=0;c<b;c++){var e=jQuery('<div class="piece" id="piece-'+(h*b+c)+'"></div>').css("top",h*d).css("left",c*d).css("height",d).css("width",d);h*b+c!=j&&e.append(i[f[h*
b+c]]);e.click(function(){a.move(jQuery(this).attr("id").match(/[0-9]+/)[0],a.blank_position);return!1});a.pieces.push(e);jQuery("#puzzle").append(e)}a.timer.start();a.started=!0;a.disable_movements=!1})},solved:function(){for(var a=0;a<b*b;a++)if(this.positions[a]!=this.solution[a])return!1;return!0},pause:function(){this.timer.stop();this.disable_movements=!0},continue_playing:function(){this.timer.start();this.disable_movements=!1},resetMovements:function(){jQuery(".moves span").html("0 moves")},
move:function(a,c){if(this.disable_movements)return!1;a=parseInt(a);c=parseInt(c);if(a!=this.blank_position&&c!=this.blank_position||a==c||a<c&&(a+1)%this.n===0&&(c+1)%this.n!==0||a>c&&(c+1)%this.n===0&&(a+1)%this.n!==0)return!1;var d=a-c<0?c-a:a-c;if(d!=1&&d!=b)return!1;d=this.positions[a];this.positions[a]=this.positions[c];this.positions[c]=d;this.blank_position=this.blank_position==a?c:a;jQuery(".piece:eq("+a+")").html("");jQuery(".piece:eq("+c+")").html(this.images[this.positions[c]]);this.moves++;
jQuery(".moves span").html(this.moves==1?"1 move":this.moves+" moves");this.solved()&&(jQuery(".play").attr("disabled",!0),jQuery(".piece:eq("+this.blank_position+")").html(this.images[this.blank_position]),this.timer.stop());return!0}}}function setLoadingMessage(){jQuery("#puzzle").html("Loading image from Instagram...")}
jQuery(document).ready(function(){$(window).width();var b,c;getCookie("instapuzzle")?c=parseInt(getCookie("instapuzzle")):(c=3,setCookie("instapuzzle",c));jQuery("#level").hide();jQuery("#level a[data-level="+c+"]").addClass("active");jQuery(".settings_controls").hide();jQuery(".play").attr("disabled",!0);setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",dataType:"jsonp",success:function(a){b=new Puzzle(c,a.data[0].images.standard_resolution.url)}});
jQuery(".play").live("click",function(){b.started?b.continue_playing():b.start();jQuery(this).removeClass("play").addClass("pause").html("Pause");return!1});jQuery(".pause").live("click",function(){b.pause();jQuery(this).removeClass("pause").addClass("play").html("Play");return!1});jQuery(".reload").live("click",function(){jQuery(".pause").trigger("click");b.timer.reset();b.resetMovements();setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",
dataType:"jsonp",success:function(a){b=new Puzzle(c,a.data[0].images.standard_resolution.url)}});return!1});jQuery(".settings").live("click",function(){jQuery(".pause").trigger("click");jQuery("#puzzle").hide();jQuery(".settings_controls").show();jQuery(".play_controls").hide();jQuery("#level").show();return!1});jQuery(".back").live("click",function(){jQuery("#puzzle").show();jQuery(".settings_controls").hide();jQuery(".play_controls").show();jQuery("#level").hide();return!1});jQuery(".level").live("click",
function(){c=parseInt($(this).attr("data-level"));setCookie("instapuzzle",c);jQuery("#level a").removeClass("active");jQuery("#level a[data-level="+c+"]").addClass("active");b.timer.reset();b.resetMovements();setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",dataType:"jsonp",success:function(a){b=new Puzzle(c,a.data[0].images.standard_resolution.url)}});jQuery("#puzzle").show();jQuery(".settings_controls").hide();jQuery(".play_controls").show();
jQuery("#level").hide();return!1});$(window).resize(function(){var a=$(window).width();a<b.instagram_image_size?a>=320&&a<=480?(a-=20,$("#puzzle").css("width",a).css("height",a)):a>480&&(a-=40,$("#puzzle").css("width",a).css("height",a)):(a=b.instagram_image_size,$("#puzzle").css("width",a).css("height",a));if($("#puzzle div").length>1)for(var c=Math.ceil(a/b.n),e=0;e<b.n;e++)for(var f=0;f<b.n;f++)typeof b.pieces[e*b.n+f]!=="undefined"&&typeof b.images[e*b.n+f]!=="undefined"&&(b.pieces[e*b.n+f].css("top",
e*c).css("left",f*c).css("height",c).css("width",c),b.images[e*b.n+f].attr("height",a).attr("width",a).css("top",-1*e*c).css("left",-1*f*c));else $("#puzzle div img").attr("height",a).attr("width",a)})});
