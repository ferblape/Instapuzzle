function setCookie(b,c){var a=new Date;a.setTime(a.getTime()+1296E6);a="; expires="+a.toGMTString();document.cookie=b+"="+c+a+"; path=/"}function getCookie(b){b+="=";for(var c=document.cookie.split(";"),a=0;a<c.length;a++){for(var e=c[a];e.charAt(0)==" ";)e=e.substring(1,e.length);if(e.indexOf(b)==0)return e.substring(b.length,e.length)}return null}
function Timer(b){return{seconds:0,minutes:0,interval:null,printTime:function(){jQuery(b).html((this.minutes<10?"0"+this.minutes:this.minutes)+":"+(this.seconds<10?"0"+this.seconds:this.seconds))},reset:function(){this.minutes=this.seconds=0;this.printTime()},increaseTime:function(){this.seconds<59?this.seconds++:(this.seconds=0,this.minutes++);this.printTime()},start:function(){this.interval=setInterval(function(b){b.increaseTime()},1E3,this)},stop:function(){this.interval=clearInterval(this.interval)}}}
function Puzzle(b,c){for(var a=b*b,e=612/b,j=[],g=[],f=0;f<a;f++)j.push(f),g.push(f);for(var g=g.sort(function(){return 0.5-Math.random()}).sort(function(){return 0.5-Math.random()}),k=g[a-1],i=[],f=0;f<b;f++)for(a=0;a<b;a++){var l=jQuery("<img />").attr("src",c).attr("height",612).attr("width",612).css("position","relative").css("top",-1*f*e).css("left",-1*a*e);i.push(l)}jQuery("#puzzle").html("");f=jQuery("<div>");solution_image=jQuery("<img />").attr("src",c);f.append(solution_image);jQuery("#puzzle").append(f);
jQuery(".play").attr("disabled",!1);return{solution:j,positions:g,blank_position:k,images:i,solution_image:null,started:!1,disable_movements:!1,n:b,timer:new Timer(".time"),moves:0,start:function(){var h=this;solution_image.fadeOut(400,function(){jQuery("#puzzle").html("");for(var d=0;d<b;d++)for(var a=0;a<b;a++){var c=jQuery('<div class="piece" id="piece-'+(d*b+a)+'"></div>').css("top",d*e).css("left",a*e).css("height",e).css("width",e);d*b+a!=k&&c.append(i[g[d*b+a]]);c.click(function(){h.move(jQuery(this).attr("id").match(/[0-9]+/)[0],
h.blank_position);return!1});jQuery("#puzzle").append(c)}h.timer.start();h.started=!0;h.disable_movements=!1})},solved:function(){for(var a=0;a<b*b;a++)if(this.positions[a]!=this.solution[a])return!1;return!0},pause:function(){this.timer.stop();this.disable_movements=!0},continue_playing:function(){this.timer.start();this.disable_movements=!1},resetMovements:function(){jQuery(".moves").html("0 moves")},move:function(a,d){if(!this.disable_movements&&(a=parseInt(a),d=parseInt(d),!(a!=this.blank_position&&
d!=this.blank_position||a==d||a<d&&(a+1)%this.n==0&&(d+1)%this.n!=0||a>d&&(d+1)%this.n==0&&(a+1)%this.n!=0))){var c=a-d<0?d-a:a-d;if(!(c!=1&&c!=b))c=this.positions[a],this.positions[a]=this.positions[d],this.positions[d]=c,this.blank_position=this.blank_position==a?d:a,jQuery(".piece:eq("+a+")").html(""),jQuery(".piece:eq("+d+")").html(this.images[this.positions[d]]),this.moves++,jQuery(".moves").html(this.moves==1?"1 move":this.moves+" moves"),this.solved()&&(jQuery(".play").attr("disabled",!0),
jQuery(".piece:eq("+this.blank_position+")").html(this.images[this.blank_position]),this.timer.stop())}}}}function setLoadingMessage(){jQuery("#puzzle").html("Loading image from Instagram...")}
jQuery(document).ready(function(){var b,c;getCookie("instapuzzle")?c=parseInt(getCookie("instapuzzle")):(c=3,setCookie("instapuzzle",c));jQuery("#level").hide();jQuery("#level a[data-level="+c+"]").addClass("active");jQuery(".settings_controls").hide();jQuery(".play").attr("disabled",!0);setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",dataType:"jsonp",success:function(a){b=new Puzzle(c,a.data[0].images.standard_resolution.url)}});
jQuery(".play").live("click",function(){b.started?b.continue_playing():b.start();jQuery(this).removeClass("play").addClass("pause").html("Pause");return!1});jQuery(".pause").live("click",function(){b.pause();jQuery(this).removeClass("pause").addClass("play").html("Play");return!1});jQuery(".reload").live("click",function(){jQuery(".pause").trigger("click");b.timer.reset();b.resetMovements();setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",
dataType:"jsonp",success:function(a){b=new Puzzle(c,a.data[0].images.standard_resolution.url)}});return!1});jQuery(".settings").live("click",function(){jQuery(".pause").trigger("click");jQuery("#puzzle").hide();jQuery(".settings_controls").show();jQuery(".play_controls").hide();jQuery("#level").show();return!1});jQuery(".back").live("click",function(){jQuery("#puzzle").show();jQuery(".settings_controls").hide();jQuery(".play_controls").show();jQuery("#level").hide();return!1});jQuery(".level").live("click",
function(){c=parseInt($(this).attr("data-level"));setCookie("instapuzzle",c);jQuery("#level a").removeClass("active");jQuery("#level a[data-level="+c+"]").addClass("active");b.timer.reset();b.resetMovements();setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",dataType:"jsonp",success:function(a){b=new Puzzle(c,a.data[0].images.standard_resolution.url)}});jQuery("#puzzle").show();jQuery(".settings_controls").hide();jQuery(".play_controls").show();
jQuery("#level").hide();return!1})});
