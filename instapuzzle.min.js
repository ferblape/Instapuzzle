function Timer(b){return{seconds:0,minutes:0,interval:null,printTime:function(){jQuery(b).html((this.minutes<10?"0"+this.minutes:this.minutes)+":"+(this.seconds<10?"0"+this.seconds:this.seconds))},reset:function(){this.minutes=this.seconds=0;this.printTime()},increaseTime:function(){this.seconds<59?this.seconds++:(this.seconds=0,this.minutes++);this.printTime()},start:function(){this.interval=setInterval(function(b){b.increaseTime()},1E3,this)},stop:function(){this.interval=clearInterval(this.interval)}}}
function Puzzle(b,e){for(var f=b*b,g=612/b,k=[],h=[],d=0;d<f;d++)k.push(d),h.push(d);for(var h=h.sort(function(){return 0.5-Math.random()}).sort(function(){return 0.5-Math.random()}),l=h[f-1],j=[],d=0;d<b;d++)for(f=0;f<b;f++){var m=jQuery("<img />").attr("src",e).attr("height",612).attr("width",612).css("position","relative").css("top",-1*d*g).css("left",-1*f*g);j.push(m)}return{solution:k,positions:h,blank_position:l,images:j,solution_image:null,started:!1,disable_movements:!1,n:b,timer:new Timer(".time"),
moves:0,build:function(){jQuery("#puzzle").html("");var a=jQuery("<div>");solution_image=jQuery("<img />").attr("src",e);a.append(solution_image);jQuery("#puzzle").append(a);this.disable_movements=this.started=!1},start:function(){var a=this;solution_image.fadeOut(400,function(){jQuery("#puzzle").html("");for(var c=0;c<b;c++)for(var i=0;i<b;i++){var d=jQuery('<div class="piece" id="piece-'+(c*b+i)+'"></div>').css("top",c*g).css("left",i*g).css("height",g).css("width",g);c*b+i!=l&&d.append(j[h[c*b+
i]]);d.click(function(){a.move(jQuery(this).attr("id").match(/[0-9]+/)[0],a.blank_position);return!1});jQuery("#puzzle").append(d)}a.timer.start();a.started=!0;a.disable_movements=!1})},solved:function(){for(var a=0;a<b*b;a++)if(this.positions[a]!=this.solution[a])return!1;return!0},pause:function(){this.timer.stop();this.disable_movements=!0},continue_playing:function(){this.timer.start();this.disable_movements=!1},resetMovements:function(){jQuery(".moves").html("0 moves")},move:function(a,c){if(!this.disable_movements&&
(a=parseInt(a),c=parseInt(c),!(a!=this.blank_position&&c!=this.blank_position||a==c||a<c&&(a+1)%this.n==0&&(c+1)%this.n!=0||a>c&&(c+1)%this.n==0&&(a+1)%this.n!=0))){var d=a-c<0?c-a:a-c;if(!(d!=1&&d!=b))d=this.positions[a],this.positions[a]=this.positions[c],this.positions[c]=d,this.blank_position=this.blank_position==a?c:a,jQuery(".piece:eq("+a+")").html(""),jQuery(".piece:eq("+c+")").html(this.images[this.positions[c]]),this.moves++,jQuery(".moves").html(this.moves==1?"1 move":this.moves+" moves"),
this.solved()&&(jQuery(".play").attr("disabled",!0),jQuery(".piece:eq("+this.blank_position+")").html(this.images[this.blank_position]),this.timer.stop())}}}}function setLoadingMessage(){jQuery("#puzzle").html("Loading image from Instagram...")}
jQuery(document).ready(function(){var b;jQuery("#level").hide();jQuery(".settings_controls").hide();jQuery(".play").attr("disabled",!0);setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",dataType:"jsonp",success:function(e){b=new Puzzle(3,e.data[0].images.standard_resolution.url);b.build();jQuery(".play").attr("disabled",!1);console.log("1.5")}});jQuery(".play").live("click",function(){b.started?b.continue_playing():b.start();
jQuery(this).removeClass("play").addClass("pause").html("Pause");return!1});jQuery(".pause").live("click",function(){b.pause();jQuery(this).removeClass("pause").addClass("play").html("Play");return!1});jQuery(".reload").live("click",function(){jQuery(".pause").trigger("click");b.timer.reset();b.resetMovements();setLoadingMessage();jQuery.ajax({url:"https://api.instagram.com/v1/media/popular?client_id=f0d3cc511b8a4f31868cab5c7f7b8f0d",dataType:"jsonp",success:function(e){b=new Puzzle(3,e.data[0].images.standard_resolution.url);
b.build();jQuery(".play").attr("disabled",!1)}});return!1});jQuery(".settings").live("click",function(){jQuery(".pause").trigger("click");jQuery("#puzzle").hide();jQuery(".settings_controls").show();jQuery(".play_controls").hide();jQuery("#level").show();return!1});jQuery(".back").live("click",function(){jQuery("#puzzle").show();jQuery(".settings_controls").hide();jQuery(".play_controls").show();jQuery("#level").hide();return!1})});
